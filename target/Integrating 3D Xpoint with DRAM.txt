将 3D Xpoint 与 DRAM 整合
作者 Robin Harris 于 星期一，2016 年 3 月 21 日
Intel 承诺将于今年发售 3D Xpoint 非易失存储器 (NVM)，至少在他们的 Optane
固态盘中。不过 Xpoint DIMMS 也快到来，而且没有哪个可以向你提供近 1,000 倍性能提升。
在最近一篇论文，NOVA: A Log-structured File System for Hybrid Volatile/Non-volatile Main Memories 中，来自加州大学圣迭戈分校的 Jian Xu 与 Steven Swanson 探讨了 NVM 集成问题。如果原来不是很清楚，发展中的 NVM 技术里，Xpoint 只是其中之一，具备更快的写操作，更高的耐久性，以及比现在固态盘中使用的 NAND flash 更高的使用寿命。
这篇论文上周发表于 UCSD 召开的非易失存储器研讨会。非易失存储器研讨会 NVMW 是由加州大学圣迭戈分校 UCSD 的非易失研究实验室与存储记录研究中心主办的。这个会议吸引了来自全世界的研究人员介绍他们的成果，建立起学术界与商业界之间的联系。
挺不错，是吧?只不过每一种存储媒介都有它的问题，NVM 也不例外。在 Jian 的摘要中:
... 管理，访问，和维护保存在 NVM 中数据的一致性引出不少挑战。现有用于旋转磁盘或固态盘的文件系统所带来的软件开销将会削弱 NVM 原本应该提供的性能，然而现在为 NVM 设计的文件系统要么也有相似的开销，要么无法提供应用需要的强一致性保证。
那么，归纳起来，这也就是为什么除非将 DRAM 与磁盘 I/O 栈针对 NVM 的特殊优势与问题进行重新设计，系统将不可能发挥出 NVM 技术的先进性。这篇论文提供了一种聪明的方法来将现有技术适配到 NVM 的全新领域中。
文中还提到:
... NOVA 采用常规的日志文件系统技术，以发挥 NVM 提供的高速随机访问优势。特别的，它还为每一个 inode 分别维护日志以提高并行性，而且将文件数据保存在日志之外来最小化日志尺寸，减少垃圾回收代价。... 实验结果展示出就写密集负载而言，NOVA 可以提供比现有文件系统高出 22% 直至 216 倍的性能提升，而且即便与提供相同强一致性保障的文件系统相比，性能也有 3.1 倍到 13.5 倍的提升。
论文提出，正确的做法是，将新型 NVM 技术附加于 DRAM，而非用作闪存或者替换固态盘 – 尽管首款 Xpoint 产品仍是 Optane 固态盘。将显著快过闪存且稍慢、稍便宜于 DRAM 的 NVM 放置在处理器的主存总线上更有意义。
然而 NVM 并非 DRAM 的理想替换品，就算不考虑延迟。
提供强一致性保证就基于内存的文件系统而言颇具挑战性，因为在 NVMM 中维护数据一致性代价不菲。当代 CPU 与主存系统常将重组数据存储于主存以改善性能，系统出现故障时一致性将被破坏。相应的，文件系统就需要显式的将数据从 CPU 缓存中刷回以强制重组数据，造成显著开销、浪费 NVMM 本可提供的性能提升。
StorageMojo 评述
这篇论文对那些将 NVM 技术向系统进行整合有专业性考虑的人士而言是必读之作。
更为重要的是，我期待着在未来5年里有几种类型的 NVM 能够进入市场。这个如何协调的分析比起我们现在讨论的 IOPS/endurance/latency 这些更为细致。
那些高杆们具备动机与资源来深入分析新技术。
将 NVM 的新颖实现商品化 – 比如说文中分析的混合存储 – 将会是一项长期且艰巨的任务，不过若我们希望改善各种计算机系统的效率与性能，那也非常关键。
欢迎讨论，当然。
